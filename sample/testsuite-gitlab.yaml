name: Gitlab
items:
    - name: projects
      before:
        items:
            - sleep(1)
      after:
        items:
            - sleep(1)
      request:
        api: https://gitlab.com/api/v4/projects
        method: GET
      expect:
        statusCode: 200
        schema: |
            {
              "type": "array"
            }
    - name: project
      request:
        api: https://gitlab.com/api/v4/projects/{{int64 (index .projects 0).id}}
        method: GET
      expect:
        statusCode: 200
        verify:
            - data.http_url_to_repo startsWith "https"
            - data.http_url_to_repo endsWith ".git"
            - data.default_branch == 'master' or data.default_branch == 'main'
            - len(data.topics) >= 0
        schema: |-
            sdsfsd
            sdsfs
