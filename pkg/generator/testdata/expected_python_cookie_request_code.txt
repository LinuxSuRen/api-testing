import io
import requests
from urllib.parse import urlencode

def main():
    data = {}
    data["key"] = "value"
    encoded_data = urlencode(data)
    body = io.BytesIO(encoded_data.encode("utf-8"))
    headers = {"User-Agent": "atest"}
    cookies = {"name": "value"}
    try:
        req = requests.Request("GET", "https://www.baidu.com", headers=headers, cookies=cookies, data=body)
    except requests.RequestException as e:
        raise e

    resp = requests.Session().send(req.prepare())
    if resp.status_code != 200:
        raise Exception("status code is not 200")

    data = resp.content
    print(data.decode("utf-8"))

if __name__ == "__main__":
    main()
